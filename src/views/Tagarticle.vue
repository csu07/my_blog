<template>
    <div class="archives">
        <main>
            <div class="main-inner">
                <div class="content">
                    <div class="post-expand">
                        <div class="posts-collapse" v-if="articles.articles">
                            <span class="archive-move-on"></span>
                            <span class="archive-page-counter">目前在 {{articles.tagName}} 标签下共计 {{articles.articles.length}} 篇日志,继续努力。</span>
                            <div class="collection-title">
                                <h3 class="archive-year">{{articles.tagName}}</h3>
                            </div>
                            <div v-for="(item,i) in articlesReverse" :key="i">
                                <article class="post">
                                    <div class="post-header">
                                        <div class="post-meta">{{time(item.created_at)}}</div>
                                        <div class="post-title">
                                            <router-link :to="{ name: 'articles', params: { id: item.post_id }}">{{item.title}}</router-link>
                                        </div>
                                    </div>
                                </article>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</template>

<script>
    import { getTagArticle } from '../api/request'
    import { formatTime } from '../utils/util'
    export default {
        name: "Tagarticle",
        data () {
            return {
                articles: {},
                articlesReverse: []
            }
        },
        mounted () {
            getTagArticle(this.$route.params.id).then(res => {
                this.articles = res.data.data

                if (res.data.data.articles){
                    this.articlesReverse = res.data.data.articles.reverse()
                }

                document.title = `${res.data.data.tagName}-sky`
            })
        },
        methods: {
            time (date) {
                return formatTime(date*1000, 'yyyy-mm-dd')
            }
        }
    }
</script>

<style lang="scss" scoped>
    .main-inner {
        width: 700px;
        height: auto;
        margin: 0 auto;
        min-width: 350px;
    }
    .content {
        margin: 0;
        padding: 0;
        min-height: 320px;
        margin-top:50px;
        .posts-expand {
            padding-top: 40px;
        }
        .posts-collapse {
            position: relative;
            margin-left: 55px;
            top: -10px;
            /*opacity: 0;*/
            animation: down 0.5s 0.5s linear;
            animation-fill-mode: both;
            &::after {
                content: ' ';
                position: absolute;
                top: 20px;
                left: 0;
                margin-left: -2px;
                width: 4px;
                height: 100%;
                background: #f5f5f5;
                z-index: -1;
            }
        }
        .archive-move-on {
            position: absolute;
            top: 11px;
            left: 0;
            margin-left: -6px;
            width: 10px;
            height: 10px;
            /*opacity: 0.5;*/
            background: #555;
            border: 1px solid #fff;
            border-radius: 50%;
        }
        .archive-page-counter {
            position: relative;
            top: 3px;
            left: 20px;
            line-height: 2;
        }
        .collection-title {
            position: relative;
            margin: 60px 0;
            line-height: 2;
            &::before {
                content: ' ';
                position: absolute;
                left: 0;
                top: 50%;
                margin-left: -4px;
                margin-top: -4px;
                width: 8px;
                height: 8px;
                background: #bbb;
                border-radius: 50%;
            }
        }
        .archive-year {
            margin-left: 20px;
            font-size: 20px;
            margin-left: 20px;
        }
        .post {
            margin: 30px 0;
        }
        .post-header {
            position: relative;
            transition: border .2s ease-in-out;
            border-bottom: 1px dashed #ccc;
            line-height: 2;
            &::before {
                content: ' ';
                position: absolute;
                left: 0;
                top: 12px;
                width: 6px;
                height: 6px;
                margin-left: -4px;
                background: #bbb;
                border-radius: 50%;
                border: 1px solid #fff;
                transition: background .2s ease-in-out;
            }
            &:hover {
                border-bottom-color: #666;
                &::before {
                    background: #666;
                }
            }
        }
        .post-meta {
            position: absolute;
            font-size: 12px;
            left: 20px;
            top: 5px;
        }
        .post-title {
            margin: 20px 0 15px 60px;
            font-size: 16px;
            font-weight: normal;
            line-height: inherit;
            a {
                color: #666;
                border-bottom: none;
            }
        }
    }

    @media only screen and(min-width: 300px)and (max-width:768px) {
        .content {
            .posts-collapse {
                margin: 0 20px;
            }
        }
    }

</style>